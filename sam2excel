Sub SplitLargeSAMFile()

    Dim filePath As String
    Dim fileNum As Integer
    Dim fileSize As Double
    Dim chunkSize As Double
    Dim numChunks As Integer
    Dim chunkNum As Integer
    Dim fileData() As Byte
    Dim i As Integer
    import java.io.*;

public class SAMSplitter {
    public static void main(String[] args) throws IOException {
        String inputFilePath = "input.sam"; // 元のファイルパス
        int chunkSize = 500 * 1024 * 1024; // ファイルを分割する単位サイズ（バイト単位）
        int bufferSize = 8192; // バッファサイズ（バイト単位）

        try (BufferedInputStream bis = new BufferedInputStream(new FileInputStream(inputFilePath), bufferSize)) {
            byte[] buffer = new byte[bufferSize];
            int bytesRead;
            int chunkIndex = 0;
            int chunkBytesWritten = 0;
            BufferedOutputStream bos = null;

            while ((bytesRead = bis.read(buffer)) != -1) {
                if (chunkBytesWritten == 0) {
                    bos = new BufferedOutputStream(new FileOutputStream(inputFilePath + ".part" + chunkIndex), bufferSize);
                }

                bos.write(buffer, 0, bytesRead);
                chunkBytesWritten += bytesRead;

                if (chunkBytesWritten >= chunkSize) {
                    bos.close();
                    chunkIndex++;
                    chunkBytesWritten = 0;
                }
            }

            if (bos != null) {
                bos.close();
            }
        }
    }
}

    ' Set the file path for the SAM file
    filePath = "C:\ExampleFolder\LargeSAMFile.sam"
    
    ' Determine the size of the file in bytes
    fileSize = FileLen(filePath)
    
    ' Set the chunk size to 500 MB
    chunkSize = 500 * 1024 * 1024
    
    ' Determine the number of chunks required
    numChunks = Int(fileSize / chunkSize) + 1
    
    ' Open the file
    fileNum = FreeFile()
    Open filePath For Binary Access Read Write As #fileNum
    
    ' Loop through each chunk and save it to a separate file
    For chunkNum = 1 To numChunks
        
        ' Determine the size of the current chunk
        If chunkNum < numChunks Then
            ReDim fileData(1 To chunkSize)
        Else
            ReDim fileData(1 To fileSize Mod chunkSize)
        End If
        
        ' Read the data from the file
        Get #fileNum, , fileData
        
        ' Save the chunk to a separate file
        Open "C:\ExampleFolder\LargeSAMFile_" & chunkNum & ".sam" For Binary Access Write As #chunkNum
        Put #chunkNum, , fileData
        Close #chunkNum
        
    Next chunkNum
    
    ' Close the original file
    Close #fileNum

End Sub
